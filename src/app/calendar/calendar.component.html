<div>
    <div>
        <button class="btn btn-primary" routerLink="facture"> Retour</button>
    </div>

    <h1>Agenda</h1>
    <ng-template #modalContent let-close="close">
        <div class="modal-header">
            <h5 class="modal-title">Event action occurred</h5>

        </div>
        <div class="modal-body">
            <div>
                Action:
                <pre>{{ modalData?.action }}</pre>
            </div>
            <div>
                Event:
                <pre>{{ modalData?.event | json }}</pre>
            </div>
        </div>

    </ng-template>

    <div class="row text-center">
        <div class="col-md-4">
            <div class="btn-group">
                <div
                    class="btn btn-primary"
                    mwlCalendarPreviousView
                    [view]="view"
                    [(viewDate)]="viewDate"
                    (viewDateChange)="activeDayIsOpen = false">
                    Avant
                </div>
                <div
                    class="btn btn-outline-secondary"
                    mwlCalendarToday
                    [(viewDate)]="viewDate">
                    Aujourd'hui
                </div>
                <div
                    class="btn btn-primary"
                    mwlCalendarNextView
                    [view]="view"
                    [(viewDate)]="viewDate"
                    (viewDateChange)="activeDayIsOpen = false">
                    Après
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <h3>{{ viewDate | calendarDate:(view + 'ViewTitle'):'en' }}</h3>
        </div>
        <div class="col-md-4">
            <div class="btn-group">
                <div
                    class="btn btn-primary"
                    (click)="view = CalendarView.Month"
                    [class.active]="view === CalendarView.Month">
                    Mois
                </div>
                <div
                    class="btn btn-primary"
                    (click)="view = CalendarView.Week"
                    [class.active]="view === CalendarView.Week">
                    Semaine
                </div>
                <div
                    class="btn btn-primary"
                    (click)="view = CalendarView.Day"
                    [class.active]="view === CalendarView.Day">
                    Jour
                </div>
            </div>
        </div>
    </div>
    <br>
    <div [ngSwitch]="view">
        <mwl-calendar-month-view
            *ngSwitchCase="CalendarView.Month"
            [viewDate]="viewDate"
            [events]="events"
            [refresh]="refresh"
            [activeDayIsOpen]="activeDayIsOpen"
            (dayClicked)="dayClicked($event.day)"
            (eventClicked)="handleEvent('Clicked', $event.event)"
            (eventTimesChanged)="eventTimesChanged($event)">
        </mwl-calendar-month-view>
        <mwl-calendar-week-view
            *ngSwitchCase="CalendarView.Week"
            [viewDate]="viewDate"
            [events]="events"
            [refresh]="refresh"
            (eventClicked)="handleEvent('Clicked', $event.event)"
            (eventTimesChanged)="eventTimesChanged($event)">
        </mwl-calendar-week-view>
        <mwl-calendar-day-view
            *ngSwitchCase="CalendarView.Day"
            [viewDate]="viewDate"
            [events]="events"
            [refresh]="refresh"
            (eventClicked)="handleEvent('Clicked', $event.event)"
            (eventTimesChanged)="eventTimesChanged($event)">
        </mwl-calendar-day-view>
    </div>

    <br><br><br>

    <h3>
        Editer
        <button
            class="btn btn-primary pull-right"
            (click)="addEvent()">
            Ajouter un nouveau pense bête
        </button>
        <div class="clearfix"></div>
    </h3>

    <table class="table table-bordered">

        <tr>
            <th>Titre</th>
            <th>Couleur 1</th>
            <th>Couleur 2</th>
            <th>Commencement</th>
            <th>Fin</th>
            <th>Supprimer</th>
        </tr>

        <tr *ngFor="let event of events; let index = index">
            <td>
                <input
                    type="text"
                    class="form-control"
                    [(ngModel)]="event.title"
                    (keyup)="refresh.next()">
            </td>
            <td>
                <input
                    type="color"
                    [(ngModel)]="event.color.primary"
                    (change)="refresh.next()">
            </td>
            <td>
                <input
                    type="color"
                    [(ngModel)]="event.color.secondary"
                    (change)="refresh.next()">
            </td>
            <td>
                <input
                    class="form-control"
                    type="text"
                    mwlFlatpickr
                    [(ngModel)]="event.start"
                    (ngModelChange)="refresh.next()"
                    [altInput]="true"
                    [convertModelValue]="true"
                    [enableTime]="true"
                    dateFormat="Y-m-dTH:i"
                    altFormat="F j, Y H:i"
                    placeholder="Pas configurer">
            </td>
            <td>
                <input
                    class="form-control"
                    type="text"
                    mwlFlatpickr
                    [(ngModel)]="event.end"
                    (ngModelChange)="refresh.next()"
                    [altInput]="true"
                    [convertModelValue]="true"
                    [enableTime]="true"
                    dateFormat="Y-m-dTH:i"
                    altFormat="F j, Y H:i"
                    placeholder="Pas configurer">
            </td>
            <td>
                <button
                    class="btn btn-danger"
                    (click)="events.splice(index, 1); refresh.next()">
                    Supprimer
                </button>
            </td>
        </tr>

    </table>

</div>
